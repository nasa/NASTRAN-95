      SUBROUTINE STPBS1(X,NCODE,BJ1,BY1)
C     SUBROUTINE BES1        J AND Y BESSEL FUNCTIONS OF FIRST ORDER
C     E. ALBANO, ORGN 3721, EXT 1022, OCT 1967
C     COMPUTES J1(X) IF X IS GREATER THAN -3.
C     COMPUTES Y1(X) IF (X IS GREATER THAN E AND NCODE = 1 ),
C           WHERE
      INTEGER NAME(2)
      DATA NAME /4HSTPB,4HS1  /
      E=0.00001
C                 REF. US DEPT OF COMMERCE HANBOOK (AMS 58)  PG. 370
      A=ABS(X)
      IF(A-3.) 10,10,100
   10 Z=X*X/9.
      BJ1=X*(0.5+Z*(-0.56249985+Z*(0.21093573+Z*(-0.03954289+Z*
     1      (0.00443319+Z*(-0.00031761+0.00001109*Z))))))
      IF(NCODE-1) 15,20,15
   15 RETURN
   20 IF(X-E) 200,25,25
   25 BY1=0.63661977*BJ1*(ALOG(X)-.69314718)+(-0.6366198 +Z*
     1   (0.2212091+Z*(2.1682709 +Z*(-1.3164827+Z*(0.3123951+Z*
     2   (-0.0400976+0.0027873*Z))))))/X
      RETURN
  100 IF(X) 250,250,110
  110 U=1./SQRT(X)
      Z=3./X
      W=0.79788456+Z*(0.00000156+Z*(0.01659667+Z*(0.00017105+Z*
     1  (-0.00249511+Z*(0.00113653-0.00020033*Z)))))
      T=X-2.35619449+Z*(0.12499612+Z*(0.00005650+Z*(-0.00637879+Z*
     1  (0.00074348+Z*(0.00079824-0.00029166*Z)))))
      UW=U*W
      BJ1=UW*COS(T)
      IF(NCODE-1) 15,120,15
  120 BY1=UW*SIN(T)
 1000 RETURN
  200 CONTINUE
  250 CONTINUE
      CALL MESAGE(-7,0,NAME)
      GO TO 1000
      END
